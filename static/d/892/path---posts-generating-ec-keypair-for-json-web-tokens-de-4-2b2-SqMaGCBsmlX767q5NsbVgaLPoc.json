{"data":{"site":{"siteMetadata":{"title":"Aubrey Oosthuizen Blog","subtitle":"Thoughts on coding, crypto and other tidbits.","copyright":"Â© All rights reserved.","author":{"name":"Aubrey Oosthuizen","twitter":"#a21n"},"disqusShortname":"","url":"https://lumen.netlify.com"}},"markdownRemark":{"id":"36186d33-e698-5501-a9ed-7f3a90deac89","html":"<h2>Generating PEM encoded keys with OpenSSL</h2>\n<p>While working on a small authentication microservice, I found myself needing to generate PEM encoded keys for use with <code class=\"language-text\">jsonwebtoken</code>. </p>\n<p>Since my authentication middleware would require verifying the signature of the token using the pubkey, using a shared secret would not be possible. </p>\n<p>I came across this <a href=\"https://gist.github.com/maxogden/62b7119909a93204c747633308a4d769\">gist</a> by <a href=\"https://github.com/maxogden\">@maxogden</a> which uses the <code class=\"language-text\">jwa</code> module, but can be adapted for the Auth0 <code class=\"language-text\">jsonwebtoken</code> module.</p>\n<p><div id=\"gist92545850\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-index-sh\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-shell \">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-index-sh-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-index-sh-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> RS256</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-index-sh-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> private key</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-index-sh-LC3\" class=\"blob-code blob-code-inner js-file-line\">openssl genrsa -out rs256-4096-private.rsa 4096</td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-index-sh-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> public key</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-index-sh-LC5\" class=\"blob-code blob-code-inner js-file-line\">openssl rsa -in rs256-4096-private.rsa -pubout <span class=\"pl-k\">&gt;</span> rs256-4096-public.pem</td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-index-sh-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-index-sh-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> ES512</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-index-sh-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> private key</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-index-sh-LC9\" class=\"blob-code blob-code-inner js-file-line\">openssl ecparam -genkey -name secp521r1 -noout -out ecdsa-p521-private.pem</td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-index-sh-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> public key</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-index-sh-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-index-sh-LC11\" class=\"blob-code blob-code-inner js-file-line\">openssl ec -in ecdsa-p521-private.pem -pubout -out ecdsa-p521-public.pem </td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/Auronmatrix/16a67d9994641eb87c339dbd6b389c2d/raw/ab4b16f513fe5bd3e49503f33b3345cc9dcb986f/index.sh\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/Auronmatrix/16a67d9994641eb87c339dbd6b389c2d#file-index-sh\">index.sh</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-test-js\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-javascript \">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-test-js-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-test-js-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> from npmjs.org/jwa. shout out to brianloveswords</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-test-js-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">fs</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>fs<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-test-js-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">jwa</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">require</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>jwa<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-test-js-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">privateKey</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">fs</span>.<span class=\"pl-en\">readFileSync</span>(<span class=\"pl-c1\">__dirname</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/ecdsa-p521-private.pem<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-test-js-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">publicKey</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">fs</span>.<span class=\"pl-en\">readFileSync</span>(<span class=\"pl-c1\">__dirname</span> <span class=\"pl-k\">+</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>/ecdsa-p521-public.pem<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-test-js-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-test-js-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">ecdsa</span> <span class=\"pl-k\">=</span> <span class=\"pl-en\">jwa</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>ES512<span class=\"pl-pds\">&#39;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-test-js-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">input</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>very important stuff<span class=\"pl-pds\">&#39;</span></span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-test-js-LC9\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-test-js-LC10\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const</span> <span class=\"pl-c1\">signature</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">ecdsa</span>.<span class=\"pl-en\">sign</span>(input, privateKey);</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-test-js-LC11\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">console</span>.<span class=\"pl-c1\">log</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>signature<span class=\"pl-pds\">&#39;</span></span>, signature)</td>\n      </tr>\n      <tr>\n        <td id=\"file-test-js-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-test-js-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-en\">console</span>.<span class=\"pl-c1\">log</span>(<span class=\"pl-s\"><span class=\"pl-pds\">&#39;</span>verify<span class=\"pl-pds\">&#39;</span></span>, <span class=\"pl-smi\">ecdsa</span>.<span class=\"pl-en\">verify</span>(input, signature, publicKey))</td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/Auronmatrix/16a67d9994641eb87c339dbd6b389c2d/raw/ab4b16f513fe5bd3e49503f33b3345cc9dcb986f/test.js\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/Auronmatrix/16a67d9994641eb87c339dbd6b389c2d#file-test-js\">test.js</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</p>","fields":{"tagSlugs":["/tags/es-512/","/tags/rs-256/","/tags/jwt/","/tags/json-web-tokens/","/tags/cryptography/","/tags/open-ssl/"]},"frontmatter":{"title":"Generating PEM encoded keys with OpenSSL","tags":["ES512","RS256","JWT","Json Web Tokens","Cryptography","Open SSL"],"date":"2018-10-18T16:51:00.000Z","description":"Using OpenSSL to generate PEM encoded keys for `jsonwebtoken`"}}},"pageContext":{"slug":"/posts/generating-ec-keypair-for-json-web-tokens/"}}